<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/WEB-INF/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:define name="title">
        Hizmetiçi Eğitim İşlemleri: Personeller
    </ui:define>

    <ui:define name="content">
        <div class="tableDiv">
            <h:dataTable class="table table-striped" value="#{tranieesController.getSelectedPersons(TrainingInfoC.selectedTraınıng)}" var ="t">

                <h:column>
                    <f:facet name="header">Kisi Adı</f:facet>
                        #{t.pinfo.EName}
                </h:column>
                <h:column>
                    <f:facet name="header">Kisi Soyadı</f:facet>
                        #{t.pinfo.ESurname}
                </h:column>
                <h:column>
                    <f:facet name="header">Kişinin Çalıştığı Departman</f:facet>
                        #{t.department.departmentName}
                </h:column>
                <h:column>
                    <f:facet name="header">Kişinin Görevi</f:facet>
                        #{t.job.jobName}
                </h:column>
                <h:column>
                    <f:facet name="header">İşlemler</f:facet>
                    <h:form>
                    <h:commandButton class="btn btn-danger" value="Sil" action="#{tranieesController.removePerson(t)}" onclick="if (!confirm('Seçili Kişi Silinecek?')) {
                                    return false;
                                }
                                ;
                                return true;
                                         " />
                    </h:form>
                </h:column>
            </h:dataTable>

        </div>
        <div class="formDiv">
            <h:form>
                Departman Seçimi:
                <h:selectOneMenu class="custom-select custom-select-lg mb-3" value="#{tranieesController.selectedDep}">
                    <f:selectItems value="#{tranieesController.depList}" var="d" itemValue="#{d.deparmentId}" itemLabel="#{d.departmentName}"/>
                </h:selectOneMenu>
                <h:commandButton class="btn btn-secondary" value="Kişileri Getir"  type="submit"/>
            </h:form>

            <h:form rendered = "#{tranieesController.isDepSelected()}">
                Kişiler:
                <h:selectManyListbox class="custom-select" value="#{tranieesController.persons}">
                     <f:converter converterId="convertStr2Int"/>
                     <f:selectItems value="#{tranieesController.personList}" var="p" itemLabel="#{(p.pinfo.EName)} #{p.pinfo.ESurname} - #{p.job.jobName}" itemValue="#{p.pinfo.PInfoId}"/>
                </h:selectManyListbox>
                <h:commandButton class="btn btn-success" value="Kişileri Ekle"  type="submit" action="#{tranieesController.addPersons()}"/>
           
            </h:form>

        </div>

    </ui:define>

</ui:composition>
